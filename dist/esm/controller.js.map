{"version":3,"file":"controller.js","sourceRoot":"","sources":["../../src/controller.ts"],"names":[],"mappings":"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","sourcesContent":["import { Capacitor } from '@capacitor/core';\r\n\r\nimport type { SafeAreaType } from './index';\r\nimport { SafeArea } from './index';\r\n\r\nclass SafeAreaElement extends HTMLElement {\r\n  mode: 'padding' | 'margin';\r\n  edges?: string;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.mode = 'padding';\r\n    // Create a shadow root\r\n    this.attachShadow({ mode: 'open' });\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.renderElement();\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    return ['mode', 'edges'];\r\n  }\r\n\r\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\r\n    if (oldValue === newValue) {\r\n      return;\r\n    }\r\n    (this as any)[name] = newValue;\r\n    this.renderElement();\r\n  }\r\n\r\n  async renderElement() {\r\n    if (this.shadowRoot) {\r\n      const safeAreaInset = await SafeArea.getSafeAreaInsets();\r\n\r\n      const isMargin = this.mode === 'margin';\r\n      const edges = this.edges?.split(',').map(item => item.trim());\r\n\r\n      const insets = {\r\n        top: edges && !edges?.includes('top') ? 0 : safeAreaInset.top,\r\n        bottom: edges && !edges?.includes('bottom') ? 0 : safeAreaInset.bottom,\r\n        left: edges && !edges?.includes('left') ? 0 : safeAreaInset.left,\r\n        right: edges && !edges?.includes('right') ? 0 : safeAreaInset.right,\r\n      };\r\n\r\n      this.shadowRoot.innerHTML = `\r\n        <style>\r\n          #wrapper {\r\n            ${isMargin ? 'margin' : 'padding'}-top: ${insets.top}px;\r\n            ${isMargin ? 'margin' : 'padding'}-bottom: ${insets.bottom}px;\r\n            ${isMargin ? 'margin' : 'padding'}-left: ${insets.left}px;\r\n            ${isMargin ? 'margin' : 'padding'}-right: ${insets.right}px;\r\n          }\r\n        </style>\r\n        <div id=\"wrapper\">\r\n          <slot></slot>\r\n        </div>\r\n      `;\r\n    }\r\n  }\r\n}\r\n\r\nif (!customElements.get('safe-area'))\r\n  customElements.define('safe-area', SafeAreaElement);\r\n\r\nclass SafeAreaController {\r\n  async injectCSSVariables(): Promise<void> {\r\n    this.addStatusBarHeight();\r\n    this.addSafeAreaVariables();\r\n  }\r\n\r\n  async addStatusBarHeight(): Promise<void> {\r\n    const { height } = await SafeArea.getStatusBarHeight();\r\n\r\n    const elStyle = document.documentElement.style;\r\n    elStyle.setProperty('--status-bar-height', `${height}px`);\r\n  }\r\n\r\n  async addSafeAreaVariables(): Promise<void> {\r\n    const safeAreaInset = await SafeArea.getSafeAreaInsets();\r\n    for (const inset in safeAreaInset) {\r\n      const elStyle = document.documentElement.style;\r\n      switch (Capacitor.getPlatform()) {\r\n        case 'android':\r\n        case 'ios':\r\n          {\r\n            elStyle.setProperty(\r\n              `--safe-area-inset-${inset}`,\r\n              `${safeAreaInset[inset as keyof SafeAreaType]}px`,\r\n            );\r\n          }\r\n          break;\r\n        default:\r\n          {\r\n            elStyle.setProperty(`--safe-area-inset-${inset}`, '0px');\r\n          }\r\n          break;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default SafeAreaController;\r\n"]}